<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الدليل للمسلم</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Inter font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- PWA Manifest File -->
    <link rel="manifest" href="/manifest.json">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: #E0E0E0;
            transition: background-color 0.3s;
        }
        .card {
            transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
            cursor: pointer;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            background-color: #1a1a1a;
        }
        .header-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        .text-gradient {
            background-image: linear-gradient(to right, #4CAF50, #2196F3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .back-button {
            transition: transform 0.3s, background-color 0.3s;
        }
        .back-button:hover {
            transform: scale(1.1);
            background-color: #2a2a2a;
        }
        .collapsible-header {
            cursor: pointer;
        }
    </style>
</head>
<body class="p-6">

    <!-- Main Container -->
    <div id="app-container" class="max-w-4xl mx-auto">
        <!-- Content will be rendered here by JavaScript -->
    </div>

    <script>
        // Check if the browser supports Service Workers and register it
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }

        // Data for the app's pages. This structure makes the app highly scalable.
        const appData = {
            mainCategories: [
                { id: 'islam', title: 'الإسلام', icon: 'fas fa-quran', description: 'تعرف على دين الإسلام', color: 'text-green-400' },
                { id: 'christianity', title: 'عقيدة النصارى', icon: 'fas fa-cross', description: 'الرد على الشبهات المسيحية', color: 'text-blue-400' },
                { id: 'atheism', title: 'الإلحاد', icon: 'fas fa-ban', description: 'الرد على شبهات الملحدين', color: 'text-red-400' },
                { id: 'quran', title: 'القرآن الكريم', icon: 'fas fa-book', description: 'استمع واقرأ وتدبر', color: 'text-purple-400' },
                { id: 'prayer', title: 'الوضوء والصلاة', icon: 'fas fa-hands-wash', description: 'تعلم كيف تتوضأ وتصلي', color: 'text-yellow-400' },
                { id: 'shayateen', title: 'الشياطين', icon: 'fas fa-mask', description: 'من هم وكيف تحمي نفسك منهم', color: 'text-gray-400' },
                { id: 'adkar', title: 'أذكار الصباح والمساء', icon: 'fas fa-praying-hands', description: 'لتحصين نفسك من الشياطين', color: 'text-pink-400' }
            ],
            subCategories: {
                islam: [
                    { id: 'pillars-of-islam', title: 'أركان الإسلام', description: 'الشهادة، الصلاة، الزكاة، الصوم، والحج.' },
                    { id: 'pillars-of-faith', title: 'أركان الإيمان', description: 'الإيمان بالله وملائكته وكتبه ورسله واليوم الآخر والقدر.' },
                    { id: 'who-is-allah', title: 'من هو الله؟', description: 'تعرف على أسماء الله الحسنى وصفاته.' },
                    { id: 'who-is-muhammad', title: 'من هو محمد؟', description: 'تعرف على سيرته وشمائله.' },
                    { id: 'shirk', title: 'الشرك وكيفية تجنبه', description: 'فهم خطورة الشرك وكيفية التوحيد.' },
                    { id: 'twasol', title: 'تحريم التوسل', description: 'الطلب من الله مباشرة دون وسيط.' },
                ],
                christianity: [
                    { id: 'trinity', title: 'الرد على عقيدة التثليث', description: 'توضيح بطلان عقيدة التثليث من القرآن.' },
                    { id: 'crucifixion', title: 'الرد على صلب المسيح', description: 'توضيح حقيقة ما حدث من منظور إسلامي.' },
                    { id: 'divinity', title: 'الرد على ألوهية المسيح', description: 'إثبات أن عيسى عليه السلام رسول وليس إله.' }
                ],
                atheism: [
                    { id: 'evidence-for-god', title: 'أدلة وجود الله', description: 'أدلة وجود الله من العقل والطبيعة.' },
                    { id: 'philosophical-arguments', title: 'الرد على الشبهات الفلسفية', description: 'مواجهة ادعاءات فلسفية مثل مشكلة الشر.' },
                    { id: 'scientific-arguments', title: 'الرد على الشبهات العلمية', description: 'توضيح أن الإسلام والعلم لا يتعارضان.' },
                    { id: 'moral-arguments', title: 'الرد على الشبهات الأخلاقية', description: 'مناقشة مصدر الأخلاق.' }
                ],
                quran: [
                    { id: 'surah-ikhlas', title: 'سورة الإخلاص', description: 'مع التفسير المختصر.' },
                    { id: 'surah-falaq', title: 'سورة الفلق', description: 'مع التفسير المختصر.' },
                    { id: 'surah-nas', title: 'سورة الناس', description: 'مع التفسير المختصر.' }
                ],
                prayer: [
                    { id: 'wudu', title: 'كيفية الوضوء', description: 'شرح خطوة بخطوة للوضوء الصحيح.' },
                    { id: 'salah', title: 'كيفية الصلاة', description: 'شرح أركان الصلاة وكيفية أدائها.' },
                    { id: 'ruku-sujud-adhkar', title: 'أذكار الركوع والسجود', description: 'ماذا تقول في الصلاة.' },
                    { id: 'validity', title: 'صحة وبطلان الصلاة', description: 'متى تكون الصلاة صحيحة ومتى تبطل.' },
                    { id: 'types', title: 'الفرائض والسنن والنوافل', description: 'أنواع الصلوات وأهميتها.' }
                ],
                shayateen: [
                    { id: 'origin', title: 'من هم الشياطين؟', description: 'من أين خلقوا وحقيقتهم.' },
                    { id: 'muslim-jinn', title: 'هل فيهم مسلمون؟', description: 'إجابة على سؤال وجود مسلمين من الجن.' },
                    { id: 'influence', title: 'كيف يتسلط على الإنسان؟', description: 'خطوات الشيطان وكيفية التغلب عليها.' },
                    { id: 'protection', title: 'كيف تتحصن منهم؟', description: 'أذكار وأفعال للحماية.' }
                ],
                adkar: [
                    { id: 'morning-adhkar', title: 'أذكار الصباح', description: 'أذكار لتحصين المسلم صباحًا.' },
                    { id: 'evening-adhkar', title: 'أذكار المساء', description: 'أذكار لتحصين المسلم مساءً.' }
                ]
            },
            contentData: {
                'pillars-of-islam': {
                    title: 'أركان الإسلام',
                    content: `
                        <p class="mb-4">أركان الإسلام خمسة، وهي الأساس الذي بُني عليه هذا الدين العظيم، وقد ذكرها النبي صلى الله عليه وسلم في حديث صحيح:</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-green-500 mb-4">
                            <p class="mb-2">عن ابن عمر رضي الله عنهما قال: سمعت رسول الله صلى الله عليه وسلم يقول: «بُنِيَ الإِسْلاَمُ عَلَى خَمْسٍ: شَهَادَةِ أَنْ لاَ إِلَهَ إِلاَّ اللَّهُ وَأَنَّ مُحَمَّدًا رَسُولُ اللَّهِ، وَإِقَامِ الصَّلاَةِ، وَإِيتَاءِ الزَّكَاةِ، وَصَوْمِ رَمَضَانَ، وَحَجِّ الْبَيْتِ».</p>
                            <p class="text-sm text-gray-400 text-left">صحيح البخاري، رقم 8</p>
                        </blockquote>
                        <ol class="list-decimal list-inside space-y-4">
                            <li><strong>الشهادتان:</strong> هي قول "أشهد أن لا إله إلا الله، وأشهد أن محمدًا رسول الله"، وهي مفتاح الدخول إلى الإسلام.</li>
                            <li><strong>إقام الصلاة:</strong> وهي الصلوات الخمس المفروضة في اليوم والليلة.</li>
                            <li><strong>إيتاء الزكاة:</strong> وهي دفع مقدار معين من المال للفقراء والمساكين.</li>
                            <li><strong>صوم رمضان:</strong> وهو الامتناع عن الطعام والشراب والجماع من الفجر إلى المغرب في شهر رمضان.</li>
                            <li><strong>حج البيت:</strong> وهو قصد بيت الله الحرام لأداء مناسك الحج لمن استطاع إليه سبيلاً.</li>
                        </ol>
                    `
                },
                'pillars-of-faith': {
                    title: 'أركان الإيمان',
                    content: `
                        <p class="mb-4">أركان الإيمان ستة، وهي الأساس العقائدي للمسلم، وقد ذكرها النبي صلى الله عليه وسلم في حديث جبريل:</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-green-500 mb-4">
                            <p class="mb-2">قال عمر بن الخطاب رضي الله عنه: قال لي جبريل عليه السلام: «فأخبرني عن الإيمان»، قال: «أن تؤمن بالله، وملائكته، وكتبه، ورسله، واليوم الآخر، وتؤمن بالقدر خيره وشره».</p>
                            <p class="text-sm text-gray-400 text-left">صحيح مسلم، رقم 8</p>
                        </blockquote>
                        <ol class="list-decimal list-inside space-y-4">
                            <li><strong>الإيمان بالله:</strong> الإقرار بوجود الله ووحدانيته في ربوبيته، وألوهيته، وأسمائه وصفاته.</li>
                            <li><strong>الإيمان بالملائكة:</strong> الإقرار بوجودهم وأنهم عباد مكرمون لا يعصون الله ما أمرهم.</li>
                            <li><strong>الإيمان بالكتب:</strong> الإقرار بأن الله أنزل كتبًا على رسله، كالقرآن والإنجيل والتوراة.</li>
                            <li><strong>الإيمان بالرسل:</strong> الإقرار بأن الله أرسل رسلاً لهداية البشر، ومحمد صلى الله عليه وسلم هو خاتمهم.</li>
                            <li><strong>الإيمان باليوم الآخر:</strong> الإقرار بوجود يوم القيامة، والحساب، والجنة، والنار.</li>
                            <li><strong>الإيمان بالقدر:</strong> الإقرار بأن كل شيء يقع في الكون هو بتقدير الله وعلمه.</li>
                        </ol>
                    `
                },
                'who-is-allah': {
                    title: 'من هو الله؟',
                    content: `
                        <p class="mb-4">الله هو الإله الواحد الأحد، الذي لا شريك له في ملكه ولا في ألوهيته، ولا في أسمائه وصفاته. هو الخالق، الرازق، المدبر، مالك الملك، وهو المستحق وحده للعبادة. قال تعالى: ﴿قُلْ هُوَ اللَّهُ أَحَدٌ ۝ اللَّهُ الصَّمَدُ ۝ لَمْ يَلِدْ وَلَمْ يُولَدْ ۝ وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ﴾.</p>
                        <p class="mb-4">إن معرفة الله تكون بالتدبر في آياته الكونية وفي القرآن الكريم، وبفهم أسمائه الحسنى وصفاته العلا. قال تعالى: ﴿وَلِلَّهِ الْأَسْمَاءُ الْحُسْنَىٰ فَادْعُوهُ بِهَا﴾ سورة الأعراف، الآية 180.</p>
                        <p>من أسمائه: الرحمن، الرحيم، الملك، القدوس، السلام، المؤمن، المهيمن، العزيز، الجبار، المتكبر، الخالق، البارئ، المصور، الغفار، القهار، الوهاب، الرزاق، الفتاح، العليم، القابض، الباسط، الخافض، الرافع، المعز، المذل، السميع، البصير، الحكم، العدل، اللطيف، الخبير، الحليم، العظيم، الغفور، الشكور، العلي، الكبير.</p>
                    `
                },
                'who-is-muhammad': {
                    title: 'من هو محمد؟',
                    content: `
                        <p class="mb-4">محمد صلى الله عليه وسلم هو خاتم الأنبياء والمرسلين، أرسله الله رحمة للعالمين، ليدعو إلى عبادة الله وحده وترك عبادة ما سواه. ولد في مكة المكرمة سنة الفيل، وعاش حياته يدعو إلى التوحيد، وتحمل في سبيل ذلك الأذى.</p>
                        <p class="mb-4">قال تعالى: ﴿مَا كَانَ مُحَمَّدٌ أَبَا أَحَدٍ مِّن رِّجَالِكُمْ وَلَٰكِن رَّسُولَ اللَّهِ وَخَاتَمَ النَّبِيِّينَ﴾ سورة الأحزاب، الآية 40.</p>
                        <p>كان يتميز بصفات عظيمة: الصدق، الأمانة، الكرم، والشجاعة. وهو قدوة للمسلمين في كل جوانب الحياة. قال تعالى: ﴿لَّقَدْ كَانَ لَكُمْ فِي رَسُولِ اللَّهِ أُسْوَةٌ حَسَنَةٌ لِّمَن كَانَ يَرْجُو اللَّهَ وَالْيَوْمَ الْآخِرَ وَذَكَرَ اللَّهَ كَثِيرًا﴾ سورة الأحزاب، الآية 21.</p>
                    `
                },
                'shirk': {
                    title: 'الشرك وكيفية تجنبه',
                    content: `
                        <p class="mb-4">الشرك هو أعظم الذنوب على الإطلاق، وهو أن تجعل لله شريكًا في العبادة. وقد حذر الله منه في القرآن الكريم فقال:</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-red-500 mb-4">
                            <p class="mb-2">﴿إِنَّ اللَّهَ لَا يَغْفِرُ أَن يُشْرَكَ بِهِ وَيَغْفِرُ مَا دُونَ ذَٰلِكَ لِمَن يَشَاءُ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة النساء، الآية 48</p>
                        </blockquote>
                        <p class="mb-4">لتجنب الشرك، يجب على المسلم أن يتعلم التوحيد ويطبقه في حياته، وأن يخلص العبادة كلها لله وحده، فلا يدعو إلا إياه، ولا يذبح إلا له، ولا يتوكل إلا عليه، وأن يكون حذرًا من الشرك الخفي مثل الرياء، وهو إظهار العبادة للناس.</p>
                    `
                },
                'twasol': {
                    title: 'تحريم التوسل',
                    content: `
                        <p class="mb-4">التوسل هو طلب المساعدة أو القرب من الله. والإسلام يقرر أن هذا الطلب يجب أن يكون <strong>مباشرة من الله وحده</strong>. تحريم التوسل يكون في حال كان الطلب من مخلوق، مثل التوسل إلى قبر نبي أو ولي لطلب الحاجة. المسلم يجب أن يرفع حاجته إلى الله وحده، لأنه هو القادر على قضاء الحوائج، ولا يملك أي مخلوق هذه القدرة.</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-green-500 mb-4">
                            <p class="mb-2">﴿وَإِذَا سَأَلَكَ عِبَادِي عَنِّي فَإِنِّي قَرِيبٌ ۖ أُجِيبُ دَعْوَةَ الدَّاعِ إِذَا دَعَانِ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة البقرة، الآية 186</p>
                        </blockquote>
                        <p>هذه الآية تؤكد على أن الله قريب من عباده، وأنهم يستطيعون دعاءه مباشرة دون أي وسيط.</p>
                    `
                },
                'validity': {
                    title: 'صحة وبطلان الصلاة',
                    content: `
                        <p class="mb-4">لكي تكون الصلاة صحيحة ومقبولة، يجب أن تتوفر فيها شروط معينة، وأن يتجنب المصلي مبطلاتها:</p>
                        <h3 class="text-2xl font-bold text-white mb-2">شروط صحة الصلاة (قبل البدء)</h3>
                        <ul class="list-disc list-inside space-y-2 mb-4">
                            <li><strong>الطهارة:</strong> طهارة البدن والثياب والمكان من النجاسات، ووجود الوضوء أو الغسل.</li>
                            <li><strong>ستر العورة:</strong> ستر ما يجب ستره من الجسم.</li>
                            <li><strong>استقبال القبلة:</strong> التوجه نحو الكعبة المشرفة.</li>
                            <li><strong>دخول الوقت:</strong> أداء الصلاة في وقتها المحدد.</li>
                            <li><strong>النية:</strong> أن ينوي المصلي بقلبه الصلاة التي يريد أداءها.</li>
                        </ul>
                        <h3 class="text-2xl font-bold text-white mb-2">مبطلات الصلاة (أثناء الصلاة)</h3>
                        <ul class="list-disc list-inside space-y-2">
                            <li><strong>الحدث:</strong> خروج الريح أو البول أو أي من نواقض الوضوء.</li>
                            <li><strong>الكلام:</strong> الكلام المتعمد بغير ذكر أو قرآن.</li>
                            <li><strong>الضحك:</strong> الضحك بصوت عالٍ.</li>
                            <li><strong>الحركة الكثيرة:</strong> الحركة التي ليست من جنس الصلاة.</li>
                            <li><strong>فقدان شرط من الشروط:</strong> كأن يزول ستر العورة أو تخرج الصلاة عن وقتها.</li>
                        </ul>
                    `
                },
                'types': {
                    title: 'الفرائض والسنن والنوافل',
                    content: `
                        <p class="mb-4">تنقسم الصلوات في الإسلام إلى ثلاثة أنواع رئيسية:</p>
                        <ol class="list-decimal list-inside space-y-4">
                            <li><strong>الصلوات المفروضة (الفرائض):</strong> هي الصلوات الخمس التي فرضها الله على كل مسلم بالغ وعاقل في اليوم والليلة، وهي: الفجر، الظهر، العصر، المغرب، والعشاء. تاركها متعمدًا كافر.</li>
                            <li><strong>الصلوات المسنونة (السنن):</strong> هي الصلوات التي واظب عليها النبي صلى الله عليه وسلم، ولها فضل كبير. منها السنن الرواتب التي تصلى قبل وبعد الفرائض، مثل ركعتي الفجر وركعتين بعد الظهر.</li>
                            <li><strong>الصلوات النافلة (الزيادة):</strong> هي الصلوات التي يفعلها المسلم تطوعًا للتقرب إلى الله، مثل صلاة الضحى وقيام الليل. فضلها عظيم، وتجبر النقص في الفرائض.</li>
                        </ol>
                    `
                },
                'morning-adhkar': {
                    title: 'أذكار الصباح',
                    content: `
                        <p class="mb-4">تحصين المسلم بأذكار الصباح أمر مهم، وإليك بعض الأذكار الشرعية من السنة النبوية:</p>
                        <ul class="list-disc list-inside space-y-4">
                            <li>"أَعُوذُ بِاللهِ مِنَ الشَّيْطَانِ الرَّجِيمِ" (مرة واحدة).</li>
                            <li>آية الكرسي: ﴿اللَّهُ لَا إِلَٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ...﴾ (مرة واحدة).</li>
                            <li>قراءة سورة الإخلاص، والفلق، والناس (ثلاث مرات).</li>
                            <li>"أَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ لِلَّهِ..." (مرة واحدة).</li>
                            <li>"اللَّهُمَّ بِكَ أَصْبَحْنَا وَبِكَ أَمْسَيْنَا..." (مرة واحدة).</li>
                            <li>"يَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ..." (مرة واحدة).</li>
                        </ul>
                    `
                },
                'evening-adhkar': {
                    title: 'أذكار المساء',
                    content: `
                        <p class="mb-4">تحصين المسلم بأذكار المساء أمر مهم، وإليك بعض الأذكار الشرعية من السنة النبوية:</p>
                        <ul class="list-disc list-inside space-y-4">
                            <li>"أَعُوذُ بِاللهِ مِنَ الشَّيْطَانِ الرَّجِيمِ" (مرة واحدة).</li>
                            <li>آية الكرسي: ﴿اللَّهُ لَا إِلَٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ...﴾ (مرة واحدة).</li>
                            <li>قراءة سورة الإخلاص، والفلق، والناس (ثلاث مرات).</li>
                            <li>"أَمْسَيْنَا وَأَمْسَى الْمُلْكُ لِلَّهِ..." (مرة واحدة).</li>
                            <li>"اللَّهُمَّ بِكَ أَمْسَيْنَا وَبِكَ أَصْبَحْنَا..." (مرة واحدة).</li>
                            <li>"أَعُوذُ بِكَلِمَاتِ اللَّهِ التَّامَّاتِ مِنْ شَرِّ مَا خَلَقَ" (ثلاث مرات).</li>
                        </ul>
                    `
                },
                'trinity': {
                    title: 'الرد على عقيدة التثليث',
                    content: `
                        <p class="mb-4">يعتقد النصارى أن الإله يتكون من ثلاثة أقانيم: الأب، والابن (عيسى)، والروح القدس. هذا المفهوم يتعارض تمامًا مع التوحيد الخالص في الإسلام. قال تعالى:</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-blue-500 mb-4">
                            <p class="mb-2">﴿لَقَدْ كَفَرَ الَّذِينَ قَالُوا إِنَّ اللَّهَ ثَالِثُ ثَلَاثَةٍ ۘ وَمَا مِنْ إِلَٰهٍ إِلَّا إِلَٰهٌ وَاحِدٌ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة المائدة، الآية 73</p>
                        </blockquote>
                        <p>الإسلام يؤكد أن الله واحد أحد، لا يشاركه أحد في ألوهيته، وأنه لم يلد ولم يولد. عيسى عليه السلام في الإسلام هو نبي ورسول عظيم، ولكنه بشر مخلوق لله، وليس إلهًا.</p>
                    `
                },
                'crucifixion': {
                    title: 'الرد على صلب المسيح',
                    content: `
                        <p class="mb-4">يؤمن المسلمون بأن عيسى عليه السلام لم يصلب، بل رفعه الله إليه. هذا يخالف ما يعتقده النصارى. قال تعالى:</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-blue-500 mb-4">
                            <p class="mb-2">﴿وَقَوْلِهِمْ إِنَّا قَتَلْنَا الْمَسِيحَ عِيسَى ابْنَ مَرْيَمَ رَسُولَ اللَّهِ وَمَا قَتَلُوهُ وَمَا صَلَبُوهُ وَلَٰكِن شُبِّهَ لَهُمْ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة النساء، الآية 157</p>
                        </blockquote>
                        <p>الآية تؤكد أن اليهود لم يقتلوا أو يصلبوا عيسى، بل شبه لهم الأمر. وفي الإسلام، عيسى عليه السلام سيعود في آخر الزمان ليحكم بشريعة الإسلام.</p>
                    `
                },
                'divinity': {
                    title: 'الرد على ألوهية المسيح',
                    content: `
                        <p class="mb-4">يعتقد النصارى أن عيسى عليه السلام هو ابن الله أو إله. القرآن الكريم ينفي ذلك بشدة ويوضح أن عيسى بشر ونبي، وكان يأكل ويشرب ويصلي مثل سائر البشر، وهي أفعال لا تليق بالإله.</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-blue-500 mb-4">
                            <p class="mb-2">﴿إِنَّ مَثَلَ عِيسَىٰ عِندَ اللَّهِ كَمَثَلِ آدَمَ ۖ خَلَقَهُ مِن تُرَابٍ ثُمَّ قَالَ لَهُ كُن فَيَكُونُ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة آل عمران، الآية 59</p>
                        </blockquote>
                        <p>هذه الآية توضح أن خلق عيسى بدون أب ليس أغرب من خلق آدم بدون أب أو أم، وكلاهما من قدرة الله.</p>
                    `
                },
                'evidence-for-god': {
                    title: 'أدلة وجود الله',
                    content: `
                        <p class="mb-4">من الأدلة على وجود الله هو النظام البديع في الكون. الكون لم يخلق صدفة، بل هو دليل على وجود خالق عظيم حكيم. قال تعالى:</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-red-500 mb-4">
                            <p class="mb-2">﴿أَفِي اللَّهِ شَكٌّ فَاطِرِ السَّمَاوَاتِ وَالْأَرْضِ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة إبراهيم، الآية 10</p>
                        </blockquote>
                        <p>كما أن الفطرة السليمة تدل على وجوده، فالإنسان بفطرته يميل إلى الإيمان بوجود خالق لهذا الكون. والعقل يرفض أن يكون هذا النظام العظيم قد أتى من العدم.</p>
                    `
                },
                'philosophical-arguments': {
                    title: 'الرد على الشبهات الفلسفية',
                    content: `
                        <p class="mb-4">واحدة من أشهر الشبهات الفلسفية هي "مشكلة الشر"، وهي كيف يمكن أن يكون هناك إله عادل وخير مع وجود الشر في العالم؟</p>
                        <p class="mb-4">الإسلام يجيب على هذه الشبهة بأن وجود الشر له حكم بالغة. فقد يكون ابتلاء لرفع الدرجات، أو تمييزًا بين المؤمن والكافر، أو فرصة للإنسان ليمارس الخير ويثاب عليه، أو ليعرف الناس نعمة العافية بعد البلاء.</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-red-500 mb-4">
                            <p class="mb-2">﴿وَلَنَبْلُوَنَّكُم بِشَيْءٍ مِّنَ الْخَوْفِ وَالْجُوعِ وَنَقْصٍ مِّنَ الْأَمْوَالِ وَالْأَنفُسِ وَالثَّمَرَاتِ ۗ وَبَشِّرِ الصَّابِرِينَ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة البقرة، الآية 155</p>
                        </blockquote>
                        <p>كما أن الله أعطى الإنسان حرية الاختيار، والكثير من الشرور هي نتيجة لأفعال الإنسان نفسه.</p>
                    `
                },
                'scientific-arguments': {
                    title: 'الرد على الشبهات العلمية',
                    content: `
                        <p class="mb-4">لا يوجد تعارض حقيقي بين العلم والإسلام، فالإسلام يحث على طلب العلم والتفكر في الكون. القرآن مليء بالآيات التي تدعو إلى التأمل في خلق السماوات والأرض، ونظام الليل والنهار، ودورة المياه، وغيرها من الظواهر الكونية التي أثبتها العلم لاحقًا. هذه الآيات ليست نظريات علمية، بل هي إشارات إلهية لتوجه الإنسان نحو الإيمان.</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-red-500 mb-4">
                            <p class="mb-2">﴿سَنُرِيهِمْ آيَاتِنَا فِي الْآفَاقِ وَفِي أَنفُسِهِمْ حَتَّىٰ يَتَبَيَّنَ لَهُمْ أَنَّهُ الْحَقُّ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة فصلت، الآية 53</p>
                        </blockquote>
                    `
                },
                'moral-arguments': {
                    title: 'الرد على الشبهات الأخلاقية',
                    content: `
                        <p class="mb-4">الملحدون يزعمون أن الأخلاق لا تحتاج إلى دين، وأنها ناتجة عن التطور الاجتماعي أو الإنساني. الإسلام يرى أن الأخلاق الحقيقية مصدرها الوحي الإلهي. فما يراه العقل خيرًا قد لا يكون كذلك دائمًا، وقد تختلف المعايير من مجتمع لآخر.</p>
                        <p class="mb-4">الدين يضع معايير ثابتة للخير والشر، ويشجع على الأخلاق الحميدة من خلال الوعد بالثواب والعقاب. قال تعالى: ﴿إِنَّمَا بُعِثْتُ لِأُتَمِّمَ مَكَارِمَ الْأَخْلَاقِ﴾ حديث رواه الإمام أحمد والبخاري في الأدب المفرد. هذا يدل على أن الأخلاق جزء لا يتجزأ من رسالة الإسلام.</p>
                    `
                },
                'surah-ikhlas': {
                    title: 'سورة الإخلاص',
                    content: `
                        <p class="mb-4 text-center text-xl font-medium">﴿قُلْ هُوَ اللَّهُ أَحَدٌ ۝ اللَّهُ الصَّمَدُ ۝ لَمْ يَلِدْ وَلَمْ يُولَدْ ۝ وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ﴾</p>
                        <button onclick="toggleTafsir('surah-ikhlas')" class="collapsible-header w-full text-right p-3 bg-gray-700 rounded-lg text-white font-bold mb-4">
                            <i class="fas fa-chevron-down ml-2"></i> اضغط لقراءة التفسير
                        </button>
                        <div id="tafsir-content-surah-ikhlas" class="hidden transition-all duration-300">
                            <p class="mb-4">سورة الإخلاص هي سورة عظيمة، تُسمى أيضًا بـ "سورة التوحيد". لقد نزلت ردًا على سؤال المشركين عن نسب الله عز وجل. فجاءت لتوحيد الله وتنزيهه عن كل ما لا يليق به.</p>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>﴿قُلْ هُوَ اللَّهُ أَحَدٌ﴾:</strong> أي قل يا محمد إن الله واحد لا شريك له.</li>
                                <li><strong>﴿اللَّهُ الصَّمَدُ﴾:</strong> أي الذي تُصمد إليه الخلائق في حاجاتها ورغباتها، وهو الذي لا جوف له.</li>
                                <li><strong>﴿لَمْ يَلِدْ وَلَمْ يُولَدْ﴾:</strong> أي لا ولد له، ولا والد له.</li>
                                <li><strong>﴿وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ﴾:</strong> أي لا مثيل له في صفاته أو أفعاله.</li>
                            </ul>
                            <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-green-500 my-4">
                                <p class="mb-2">عن أبي سعيد الخدري رضي الله عنه أن رجلاً سمع رجلاً يقرأ: ﴿قُلْ هُوَ اللَّهُ أَحَدٌ﴾ يرددها، فلما أصبح جاء إلى رسول الله صلى الله عليه وسلم فذكر ذلك له، وكأن الرجل يتقالُّها، فقال رسول الله صلى الله عليه وسلم: «وَالَّذِي نَفْسِي بِيَدِهِ إِنَّهَا لَتَعْدِلُ ثُلُثَ الْقُرْآنِ».</p>
                                <p class="text-sm text-gray-400 text-left">صحيح البخاري، رقم 5013</p>
                            </blockquote>
                        </div>
                    `
                },
                'surah-falaq': {
                    title: 'سورة الفلق',
                    content: `
                        <p class="mb-4 text-center text-xl font-medium">﴿قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ ۝ مِن شَرِّ مَا خَلَقَ ۝ وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ ۝ وَمِن شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ ۝ وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ﴾</p>
                        <button onclick="toggleTafsir('surah-falaq')" class="collapsible-header w-full text-right p-3 bg-gray-700 rounded-lg text-white font-bold mb-4">
                            <i class="fas fa-chevron-down ml-2"></i> اضغط لقراءة التفسير
                        </button>
                        <div id="tafsir-content-surah-falaq" class="hidden transition-all duration-300">
                            <p class="mb-4">سورة الفلق هي سورة استعاذة، حيث يأمرنا الله بأن نلجأ إليه ونطلب منه الحماية من كل أنواع الشرور في هذا العالم.</p>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>﴿قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ﴾:</strong> أي قل يا محمد ألتجئ وأعتصم برب الصبح.</li>
                                <li><strong>﴿مِن شَرِّ مَا خَلَقَ﴾:</strong> من شر كل شيء خلقه الله.</li>
                                <li><strong>﴿وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ﴾:</strong> من شر الليل إذا أظلم ودخل في كل شيء، بما يحمله من شرور.</li>
                                <li><strong>﴿وَمِن شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ﴾:</strong> من شر الساحرات اللاتي ينفثن في عقد السحر.</li>
                                <li><strong>﴿وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ﴾:</strong> من شر الحاسد إذا أظهر حسده.</li>
                            </ul>
                            <p class="mt-4">هذه السورة تُقرأ مع سورة الناس لتحصين النفس من شرور الجن والإنس.</p>
                        </div>
                    `
                },
                'surah-nas': {
                    title: 'سورة الناس',
                    content: `
                        <p class="mb-4 text-center text-xl font-medium">﴿قُلْ أَعُوذُ بِرَبِّ النَّاسِ ۝ مَلِكِ النَّاسِ ۝ إِلَٰهِ النَّاسِ ۝ مِن شَرِّ الْوَسْوَاسِ الْخَنَّاسِ ۝ الَّذِي يُوَسْوَسُ فِي صُدُورِ النَّاسِ ۝ مِنَ الْجِنَّةِ وَالنَّاسِ﴾</p>
                        <button onclick="toggleTafsir('surah-nas')" class="collapsible-header w-full text-right p-3 bg-gray-700 rounded-lg text-white font-bold mb-4">
                            <i class="fas fa-chevron-down ml-2"></i> اضغط لقراءة التفسير
                        </button>
                        <div id="tafsir-content-surah-nas" class="hidden transition-all duration-300">
                            <p class="mb-4">سورة الناس هي سورة استعاذة أيضًا، خاصةً من شر الوسواس الخناس.</p>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>﴿قُلْ أَعُوذُ بِرَبِّ النَّاسِ ۝ مَلِكِ النَّاسِ ۝ إِلَٰهِ النَّاسِ﴾:</strong> التوسل إلى الله بصفاته الثلاثة: الربوبية، والملك، والألوهية، لطلب الحماية.</li>
                                <li><strong>﴿مِن شَرِّ الْوَسْوَاسِ الْخَنَّاسِ﴾:</strong> من شر الشيطان الذي يلقي الوساوس في القلب، وإذا ذُكر الله خنس وتراجع.</li>
                                <li><strong>﴿الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ﴾:</strong> الذي يلقي الأفكار الشريرة في قلوب البشر.</li>
                                <li><strong>﴿مِنَ الْجِنَّةِ وَالنَّاسِ﴾:</strong> أي أن هؤلاء الموسوسين قد يكونون من الجن أو من بني آدم.</li>
                            </ul>
                        </div>
                    `
                },
                'wudu': {
                    title: 'كيفية الوضوء',
                    content: `
                        <p class="mb-4">الوضوء هو شرط أساسي لصحة الصلاة، وإليك خطواته بشكل مبسط:</p>
                        <ol class="list-decimal list-inside space-y-4">
                            <li><strong>النية:</strong> يجب أن تنوي بقلبك أنك تتوضأ للصلاة.</li>
                            <li><strong>التسمية:</strong> تقول "بسم الله الرحمن الرحيم".</li>
                            <li><strong>غسل الكفين:</strong> تغسل كفيك ثلاث مرات.</li>
                            <li><strong>المضمضة والاستنشاق:</strong> تتمضمض وتستنشق ثلاث مرات.</li>
                            <li><strong>غسل الوجه:</strong> تغسل وجهك ثلاث مرات.</li>
                            <li><strong>غسل اليدين إلى المرفقين:</strong> تغسل يدك اليمنى إلى المرفق ثلاث مرات، ثم يدك اليسرى.</li>
                            <li><strong>مسح الرأس:</strong> تمسح رأسك مرة واحدة من الأمام إلى الخلف ثم تعود.</li>
                            <li><strong>مسح الأذنين:</strong> تمسح أذنيك مرة واحدة بماء جديد.</li>
                            <li><strong>غسل الرجلين إلى الكعبين:</strong> تغسل رجلك اليمنى إلى الكعبين ثلاث مرات، ثم رجلك اليسرى.</li>
                            <li><strong>الدعاء بعد الوضوء:</strong> تقول "أشهد أن لا إله إلا الله وحده لا شريك له، وأشهد أن محمدًا عبده ورسوله".</li>
                        </ol>
                    `
                },
                'salah': {
                    title: 'كيفية الصلاة',
                    content: `
                        <p class="mb-4">الصلاة هي عمود الدين، وإليك خطواتها بشكل مختصر:</p>
                        <ol class="list-decimal list-inside space-y-4">
                            <li><strong>النية والقبلة:</strong> تنوي الصلاة وتستقبل القبلة.</li>
                            <li><strong>تكبيرة الإحرام:</strong> ترفع يديك وتقول "الله أكبر".</li>
                            <li><strong>القيام وقراءة الفاتحة:</strong> تقرأ سورة الفاتحة وما تيسر من القرآن.</li>
                            <li><strong>الركوع:</strong> تنحني بظهرك وتضع يديك على ركبتيك وتقول "سبحان ربي العظيم" ثلاث مرات.</li>
                            <li><strong>الاعتدال:</strong> ترفع من الركوع وتقول "سمع الله لمن حمده" ثم "ربنا ولك الحمد".</li>
                            <li><strong>السجود:</strong> تسجد على سبعة أعضاء (الوجه، الكفين، الركبتين، وأطراف القدمين) وتقول "سبحان ربي الأعلى" ثلاث مرات.</li>
                            <li><strong>الجلوس بين السجدتين:</strong> تجلس وتقول "رب اغفر لي".</li>
                            <li><strong>السجدة الثانية:</strong> تسجد مرة أخرى.</li>
                            <li><strong>القيام للركعة الثانية:</strong> تكرر الخطوات من الثالثة إلى السابعة.</li>
                            <li><strong>التشهد الأخير والسلام:</strong> في الركعة الأخيرة تجلس للتشهد وتصلي على النبي، ثم تسلم على اليمين واليسار.</li>
                        </ol>
                    `
                },
                'ruku-sujud-adhkar': {
                    title: 'أذكار الركوع والسجود',
                    content: `
                        <p class="mb-4">هذه هي الأذكار الواجبة والمستحبة في الركوع والسجود:</p>
                        <ul class="list-disc list-inside space-y-4">
                            <li><strong>في الركوع:</strong>
                                <ul class="list-inside list-circle mr-4">
                                    <li>"سبحان ربي العظيم" (ثلاث مرات).</li>
                                    <li>"سبحانك اللهم وبحمدك، اللهم اغفر لي".</li>
                                </ul>
                            </li>
                            <li><strong>عند الرفع من الركوع:</strong>
                                <ul class="list-inside list-circle mr-4">
                                    <li>"سمع الله لمن حمده".</li>
                                    <li>"ربنا ولك الحمد".</li>
                                </ul>
                            </li>
                            <li><strong>في السجود:</strong>
                                <ul class="list-inside list-circle mr-4">
                                    <li>"سبحان ربي الأعلى" (ثلاث مرات).</li>
                                    <li>"اللهم اغفر لي".</li>
                                </ul>
                            </li>
                            <li><strong>بين السجدتين:</strong>
                                <ul class="list-inside list-circle mr-4">
                                    <li>"رب اغفر لي، رب اغفر لي".</li>
                                </ul>
                            </li>
                        </ul>
                    `
                },
                'origin': {
                    title: 'من هم الشياطين؟',
                    content: `
                        <p class="mb-4">الشياطين هم من جنس الجن، وقد خُلقوا من نار، وخلق الله الجن والإنس لعبادته. والشيطان الأكبر هو إبليس، الذي عصى أمر الله بالسجود لآدم.</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-gray-500 mb-4">
                            <p class="mb-2">﴿وَإِذْ قُلْنَا لِلْمَلَائِكَةِ اسْجُدُوا لِآدَمَ فَسَجَدُوا إِلَّا إِبْلِيسَ كَانَ مِنَ الْجِنِّ فَفَسَقَ عَنْ أَمْرِ رَبِّهِ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة الكهف، الآية 50</p>
                        </blockquote>
                        <p>منذ ذلك الحين، أصبح إبليس وذريته أعداءً للإنس، يسعون لإضلالهم وإغوائهم عن صراط الله المستقيم.</p>
                    `
                },
                'muslim-jinn': {
                    title: 'هل فيهم مسلمون؟',
                    content: `
                        <p class="mb-4">نعم، ليس كل الجن شياطين. فالشياطين هم الكفرة والعصاة من الجن. هناك جن مسلمون، يؤمنون بالله ورسوله، ويطيعون أوامره.</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-gray-500 mb-4">
                            <p class="mb-2">﴿وَإِذْ صَرَفْنَا إِلَيْكَ نَفَرًا مِّنَ الْجِنِّ يَسْتَمِعُونَ الْقُرْآنَ فَلَمَّا حَضَرُوهُ قَالُوا أَنصِتُوا ۖ فَلَمَّا قُضِيَ وَلَّوْا إِلَىٰ قَوْمِهِم مُّنذِرِينَ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة الأحقاف، الآية 29</p>
                        </blockquote>
                        <p>هذه الآية تثبت وجود جن يؤمنون بالقرآن، ويدعون قومهم للإيمان.</p>
                    `
                },
                'influence': {
                    title: 'كيف يتسلط على الإنسان؟',
                    content: `
                        <p class="mb-4">يتسلط الشيطان على الإنسان بطرق متعددة، أهمها الوسوسة، وهي إلقاء الأفكار والشكوك في قلب الإنسان. قال تعالى:</p>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-gray-500 mb-4">
                            <p class="mb-2">﴿مِن شَرِّ الْوَسْوَاسِ الْخَنَّاسِ ۝ الَّذِي يُوَسْوَسُ فِي صُدُورِ النَّاسِ﴾</p>
                            <p class="text-sm text-gray-400 text-left">سورة الناس، الآية 4-5</p>
                        </blockquote>
                        <p>كما يمكن أن يزين لهم المعصية، ويعدهم بالفقر، ويخوفهم من الحق، ويدعوهم إلى الشرك بالله.</p>
                    `
                },
                'protection': {
                    title: 'كيف تتحصن منهم؟',
                    content: `
                        <p class="mb-4">يمكن للمسلم أن يحمي نفسه من الشياطين من خلال عدة أمور، أهمها الإيمان والتقرب إلى الله:</p>
                        <ul class="list-disc list-inside space-y-2 mb-4">
                            <li><strong>الاستعاذة بالله:</strong> قول "أعوذ بالله من الشيطان الرجيم".</li>
                            <li><strong>قراءة القرآن:</strong> خاصةً سورة البقرة وآية الكرسي، فإنهما يطردان الشيطان.</li>
                            <li><strong>أذكار الصباح والمساء:</strong> المداومة عليها تقوي المسلم وتحصنه.</li>
                            <li><strong>الوضوء:</strong> الوضوء المتكرر يضعف تأثير الشياطين.</li>
                            <li><strong>ذكر الله:</strong> ذكر الله في كل الأوقات يطرد الشيطان.</li>
                        </ul>
                        <blockquote class="bg-gray-700 p-4 rounded-xl border-r-4 border-gray-500 mb-4">
                            <p class="mb-2">قال رسول الله صلى الله عليه وسلم: «إن الشيطان إذا سمع النداء بالصلاة أدبر وله ضراط حتى لا يسمع صوت التأذين، فإذا سكت رجع فوسوس، فإذا سمع الإقامة أدبر، فإذا سكت رجع فوسوس».</p>
                            <p class="text-sm text-gray-400 text-left">صحيح البخاري، رقم 608</p>
                        </blockquote>
                        <p>هذا الحديث يوضح كيف أن ذكر الله يطرد الشيطان.</p>
                    `
                },
            }
        };

        const appContainer = document.getElementById('app-container');

        // Render the main categories page
        function renderMainPage() {
            let htmlContent = `
                <!-- Header Section -->
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-extrabold mb-1 text-white">الدليل للمسلم</h1>
                    <h2 class="text-xl font-medium text-gray-400">الفئات الرئيسية</h2>
                </div>
                <!-- Cards Section -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            `;
            appData.mainCategories.forEach(category => {
                htmlContent += `
                    <div onclick="handleClick('${category.id}')" class="card bg-gray-800 rounded-2xl p-6 flex flex-col items-center text-center shadow-lg">
                        <div class="header-icon ${category.color}">
                            <i class="${category.icon}"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">${category.title}</h3>
                        <p class="text-sm text-gray-400">${category.description}</p>
                    </div>
                `;
            });
            htmlContent += `</div>`;
            appContainer.innerHTML = htmlContent;
        }

        // Render a sub-category page based on the main category ID
        function renderSubCategoriesPage(categoryId) {
            const mainCategory = appData.mainCategories.find(cat => cat.id === categoryId);
            const subCategories = appData.subCategories[categoryId];

            let htmlContent = `
                <!-- Back Button -->
                <div class="mb-8">
                    <button onclick="renderMainPage()" class="back-button text-white text-2xl p-2 rounded-full hover:bg-gray-800 transition-colors duration-200">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
                <!-- Header Section -->
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-extrabold mb-1 text-white">${mainCategory.title}</h1>
                    <h2 class="text-xl font-medium text-gray-400">${mainCategory.description}</h2>
                </div>
                <!-- Sub-Category Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            `;
            if (subCategories) {
                subCategories.forEach(subCat => {
                    htmlContent += `
                        <div onclick="handleSubClick('${categoryId}', '${subCat.id}')" class="card bg-gray-800 rounded-2xl p-6 flex flex-col items-start text-right shadow-lg">
                            <h3 class="text-xl font-bold text-white mb-1">${subCat.title}</h3>
                            <p class="text-sm text-gray-400">${subCat.description}</p>
                        </div>
                    `;
                });
            } else {
                 htmlContent += `<p class="text-gray-400 text-center col-span-2">لا توجد مواضيع متاحة لهذه الفئة حاليًا.</p>`;
            }
            htmlContent += `</div>`;
            appContainer.innerHTML = htmlContent;
        }

        // Render content for a specific lesson/topic
        function renderLessonPage(categoryId, lessonId) {
            const content = appData.contentData[lessonId];
            if (!content) {
                // This fallback is now redundant, but kept for future-proofing
                let htmlContent = `
                    <div class="mb-8">
                        <button onclick="renderSubCategoriesPage('${categoryId}')" class="back-button text-white text-2xl p-2 rounded-full hover:bg-gray-800 transition-colors duration-200">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <div class="bg-gray-800 rounded-2xl p-8 shadow-lg">
                        <h1 class="text-3xl font-extrabold text-white mb-4 text-center">قريباً</h1>
                        <div class="text-lg leading-relaxed text-gray-300">
                            <p class="text-center text-gray-400">هذه الصفحة قيد الإنشاء. يرجى العودة لاحقًا.</p>
                        </div>
                    </div>
                `;
                appContainer.innerHTML = htmlContent;
                return;
            }
        
            let htmlContent = `
                <!-- Back Button -->
                <div class="mb-8">
                    <button onclick="renderSubCategoriesPage('${categoryId}')" class="back-button text-white text-2xl p-2 rounded-full hover:bg-gray-800 transition-colors duration-200">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
                <!-- Content Section -->
                <div class="bg-gray-800 rounded-2xl p-8 shadow-lg">
                    <h1 class="text-3xl font-extrabold text-white mb-4 text-center">${content.title}</h1>
                    <div id="lesson-content" class="text-lg leading-relaxed text-gray-300">
                        ${content.content}
                    </div>
                </div>
            `;
            appContainer.innerHTML = htmlContent;
        }

        /**
         * The main routing function.
         * @param {string} categoryId The ID of the main category card clicked.
         */
        function handleClick(categoryId) {
            if (appData.subCategories[categoryId]) {
                renderSubCategoriesPage(categoryId);
            } else {
                renderLessonPage(categoryId, 'default');
            }
        }

        /**
         * Handles the click on a sub-category card.
         * @param {string} categoryId The parent category ID.
         * @param {string} lessonId The specific lesson ID.
         */
        function handleSubClick(categoryId, lessonId) {
            renderLessonPage(categoryId, lessonId);
        }

        /**
         * Toggles the display of the Tafsir content.
         * @param {string} surahId The ID of the surah to toggle.
         */
        function toggleTafsir(surahId) {
            const tafsirDiv = document.getElementById(`tafsir-content-${surahId}`);
            if (tafsirDiv.classList.contains('hidden')) {
                tafsirDiv.classList.remove('hidden');
            } else {
                tafsirDiv.classList.add('hidden');
            }
        }
        
        // Initial render on page load
        renderMainPage();
    </script>
</body>
</html>
